{% extends "_base.html" %}
{% block content %}
{% set pill_classes = {
  "TOPUP": "tx-pill tx-pill-topup",
  "DEBIT": "tx-pill tx-pill-debit",
  "REFUND": "tx-pill tx-pill-refund",
  "ADJUST": "tx-pill tx-pill-adjust"
} %}
<h4>Transactions</h4>
<form class="row g-2 mb-2">
  <div class="col-md-3">
    <input class="form-control" type="number" name="limit" min="1" max="500" value="{{ limit }}">
  </div>
  <div class="col-md-2 d-grid">
    <button class="btn btn-outline-secondary">Refresh</button>
  </div>
</form>

<div class="table-responsive">
<table class="table table-sm align-middle">
  <thead><tr><th>Time (UTC+8)</th><th>Name</th><th>Type</th><th class="text-end">Amount</th><th>Overpay</th></tr></thead>
  <tbody>
    {% for r in tx %}
    <tr>
      <td>{{ r.created_at|fmt_ts }}</td>
      <td>{{ r.name }}</td>
      <td><span class="{{ pill_classes.get(r.type, 'tx-pill tx-pill-default') }}">{{ r.type }}</span></td>
      <td class="text-end">
        {% if r.amount < 0 %}
          <span class="amount-neg">-¥{{ -r.amount }}</span>
        {% else %}
          <span class="amount-pos">¥{{ r.amount }}</span>
        {% endif %}
      </td>
      <td>{% if r.overdraft_component %}¥{{ r.overdraft_component }}{% else %}—{% endif %}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}
